<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Extending Nikola | Antipodae</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (fr)" href="../../rss.xml">
<link rel="canonical" href="http://antipodae.fr/fr/stories/extending/">
<!--[if lt IE 9]>
            <script src="../../../assets/js/html5shiv.min.js"></script>
            <script src="../../../assets/js/respond.min.js"></script>
        <![endif]--><link href="https://fonts.googleapis.com/css?family=Playfair+Display%7CRaleway:200,400,700" rel="stylesheet">
<meta name="author" content="The Nikola Team">
<meta property="og:site_name" content="Antipodae">
<meta property="og:title" content="Extending Nikola">
<meta property="og:url" content="http://antipodae.fr/fr/stories/extending/">
<meta property="og:description" content="Extending Nikola




Version:7.7.12

Author:Roberto Alsina &lt;ralsina@netmanagers.com.ar&gt;




Contents 
 
Ex­ten­ding Ni­ko­la 
 Com­­mand Plu­­gins  
  Tem­­pla­­te­­Sys­­tem Plu­­gins  
  Task Plu­­gi">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2012-03-30T23:00:00-03:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@antipodaefr">
<meta name="twitter:creator" content="@antipodaefr">
<link rel="alternate" hreflang="en" href="../../../stories/extending/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Aller au contenu principal</a>

<!-- Menubar -->

<nav class="navbar  header-panel shadow-z-3" role="navigation"><div class="container-fluid">
        <div class="row">
          <div class="col-xs-3">
            <h1 class="title-blog">
                <a href="http://antipodae.fr/fr/">
                        <img src="../../../images/logo150.png" alt="Antipodae" id="logo"></a>
            </h1>
          </div>
        </div>
      </div>
<!-- /.container-fluid -->
</nav><div class="container-fluid main" id="content" role="main">
        <div class="row">
            <nav class="col-xs-3 menu"><ul>
<li class="withripple"><a href="../../archive.html">Archives</a></li>
                <li class="withripple"><a href="../../categories/">Étiquettes</a></li>
                <li class="withripple"><a href="../../rss.xml">Flux&nbsp;RSS</a></li>

                    
                </ul>
<ul class="nav navbar-nav">
<li>            </li>
<li><a href="http://antipodae.fr/" rel="alternate" hreflang="en">English</a></li>

                    
                </ul></nav><div class="posts-material col-xs-9">
                <div class="col-xs-12 col-md-11 content-material">
<article class="post- storypage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Extending&nbsp;Nikola</a></h1>
<hr></header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<div class="section" id="extending-nikola">
<h2><a class="toc-backref" href="#id1">Extending&nbsp;Nikola</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name">
<col class="field-body">
<tbody valign="top">
<tr class="field">
<th class="field-name">Version:</th>
<td class="field-body">7.7.12</td>
</tr>
<tr class="field">
<th class="field-name">Author:</th>
<td class="field-body">Roberto Alsina &lt;<a class="reference external" href="mailto:ralsina@netmanagers.com.ar">ralsina@netmanagers.com.ar</a>&gt;</td>
</tr>
</tbody>
</table>
<div class="contents alert alert-info pull-right topic" id="contents">
<p class="topic-title first">Contents</p> 
 <ul class="simple">
<li>
<a class="reference internal" href="#extending-nikola" id="id1">Ex­ten­ding Ni­ko­la</a><ul>
<li><a class="reference internal" href="#command-plugins" id="id2">Com­­mand&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#templatesystem-plugins" id="id3">Tem­­pla­­te­­Sys­­tem&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#task-plugins" id="id4">Task&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#pagecompiler-plugins" id="id5">Pa­­ge­­Com­­pi­­ler&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#restextension-plugins" id="id6">Re­s­­tEx­­ten­­sion&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#markdownextension-plugins" id="id7">Mark­­dow­­nEx­­ten­­sion&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#signalhandler-plugins" id="id8">Si­­gnal­­Hand­­ler&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#configplugin-plugins" id="id9">Config­­Plu­­gin&nbsp;Plu­­gins</a></li>  
  <li><a class="reference internal" href="#postscanner-plugins" id="id10">Post­S­can­­ner&nbsp;Plu­­gins</a></li>  
  </ul>
</li> 
 <li><a class="reference internal" href="#plugin-index" id="id11">Plu­gin&nbsp;In­dex</a></li> 
 <li><a class="reference internal" href="#path-link-resolution-mechanism" id="id12">Pa­th/­Link Re­so­lu­tion&nbsp;Me­cha­nism</a></li> 
 <li><a class="reference internal" href="#template-hooks" id="id13">Tem­plate&nbsp;Hooks</a></li> 
 <li>
<a class="reference internal" href="#shortcodes" id="id14">Short­codes</a><ul>
<li><a class="reference internal" href="#template-based-shortcodes" id="id15">Tem­­plate-­­ba­­sed&nbsp;Short­­codes</a></li>  
  </ul>
</li> 
 <li><a class="reference internal" href="#state-and-cache" id="id16">State and&nbsp;Cache</a></li> 
 </ul>
</div>
<p class="lead">Ni­ko­la is ex­ten­sible. Al­most all its func­tio­na­li­ty is ba­sed on plu­gins,
and you can add your own or re­place the pro­vi­ded&nbsp;ones.</p> 
 <p>Plu­gins consist of a me­ta­da­ta file (with  <tt class="docutils literal">.plu­gin</tt>  ex­ten­sion) and
a Py­thon mo­dule (a  <tt class="docutils literal">.py</tt>  fi­le) or pa­ckage (a fol­der contai­ning
a  <tt class="docutils literal">__i­nit__.­py</tt>  file.</p> 
 <p>To use a plu­gin in your si­te, you just have to put it in a  <tt class="docutils literal">plu­gins</tt> 
fol­der in your&nbsp;site.</p> 
 <p>Plu­gins come in va­rious fla­vours, ai­med at ex­ten­ding dif­ferent as­pects
of&nbsp;Ni­ko­la.</p> 
 <div class="section" id="command-plugins">
<h3><a class="toc-backref" href="#id2">Command&nbsp;Plugins</a></h3>
<p>When you run  <tt class="docutils literal">ni­ko­la  <span class="pre">--­­help</span></tt>  you will see so­me­thing like&nbsp;this:</p> 
 <pre class="code console"><a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-1"></a><span class="gp">$</span> nikola <span class="nb">help</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-2"></a><span class="go">Nikola is a tool to create static websites and blogs. For full documentation and more</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-3"></a><span class="go">information, please visit https://getnikola.com/</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-4"></a>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-5"></a>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-6"></a><span class="go">Available commands:</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-7"></a><span class="go">nikola auto                 automatically detect site changes, rebuild</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-8"></a><span class="go">                            and optionally refresh a browser</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-9"></a><span class="go">nikola bootswatch_theme     given a swatch name from bootswatch.com and a</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-10"></a><span class="go">                            parent theme, creates a custom theme</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-11"></a><span class="go">nikola build                run tasks</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-12"></a><span class="go">nikola check                check links and files in the generated site</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-13"></a><span class="go">nikola clean                clean action / remove targets</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-14"></a><span class="go">nikola console              start an interactive python console with access to</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-15"></a><span class="go">                            your site and configuration</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-16"></a><span class="go">nikola deploy               deploy the site</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-17"></a><span class="go">nikola dumpdb               dump dependency DB</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-18"></a><span class="go">nikola forget               clear successful run status from internal DB</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-19"></a><span class="go">nikola help                 show help</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-20"></a><span class="go">nikola ignore               ignore task (skip) on subsequent runs</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-21"></a><span class="go">nikola import_blogger       import a blogger dump</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-22"></a><span class="go">nikola import_feed          import a RSS/Atom dump</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-23"></a><span class="go">nikola import_wordpress     import a WordPress dump</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-24"></a><span class="go">nikola init                 create a Nikola site in the specified folder</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-25"></a><span class="go">nikola list                 list tasks from dodo file</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-26"></a><span class="go">nikola mincss               apply mincss to the generated site</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-27"></a><span class="go">nikola new_post             create a new blog post or site page</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-28"></a><span class="go">nikola run                  run tasks</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-29"></a><span class="go">nikola serve                start the test webserver</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-30"></a><span class="go">nikola strace               use strace to list file_deps and targets</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-31"></a><span class="go">nikola theme                manage themes</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-32"></a><span class="go">nikola version              print the Nikola version number</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-33"></a>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-34"></a><span class="go">nikola help                 show help / reference</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-35"></a><span class="go">nikola help &lt;command&gt;       show command usage</span>
<a name="rest_code_93f38c5e350a4becb6917fb14e9d2c9f-36"></a><span class="go">nikola help &lt;task-name&gt;     show task usage</span>
</pre>
<p>That will give you a list of all avai­lable com­mands in your ver­sion of Ni­ko­la.
Each and eve­ry one of those is a plu­gin. Let&#8217;s look at a ty­pi­cal&nbsp;exam­ple:</p> 
 <p>First, the  <tt class="docutils literal">serve.­plu­gin</tt>  fi­le:</p> 
 <pre class="code ini"><a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-1"></a><span class="k">[Core]</span>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-2"></a><span class="na">Name</span> <span class="o">=</span> <span class="s">serve</span>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-3"></a><span class="na">Module</span> <span class="o">=</span> <span class="s">serve</span>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-4"></a>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-5"></a><span class="k">[Documentation]</span>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-6"></a><span class="na">Author</span> <span class="o">=</span> <span class="s">Roberto Alsina</span>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-7"></a><span class="na">Version</span> <span class="o">=</span> <span class="s">0.1</span>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-8"></a><span class="na">Website</span> <span class="o">=</span> <span class="s">https://getnikola.com</span>
<a name="rest_code_6f4adfa6d7824d74823fd3d8315e64e9-9"></a><span class="na">Description</span> <span class="o">=</span> <span class="s">Start test server.</span>
</pre>
<div class="admonition note">
<p class="first admonition-title">Note</p> 
 <p class="last">If you want to pu­blish your plu­gin on the Plu­gin In­dex,  <a class="reference external" href="https://github.com/getnikola/plugins/blob/master/README.md">read
the docs for the In­dex</a> 
(and the .plu­gin file examples and&nbsp;ex­pla­na­tions).</p> 
 </div>
<p>For your own plu­gin, just change the va­lues in a sen­sible way. The
 <tt class="docutils literal">Mo­dule</tt>  will be used to find the mat­ching Py­thon mo­du­le, in this ca­se
 <tt class="docutils literal">serve.­py</tt>, from which this is the in­ter­es­ting&nbsp;bit:</p> 
 <pre class="code python"><a name="rest_code_41392e3556494ff3b131a68102bfd75d-1"></a><span class="kn">from</span> <span class="nn">nikola.plugin_categories</span> <span class="kn">import</span> <span class="n">Command</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-2"></a>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-3"></a><span class="c1"># You have to inherit Command for this to be a</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-4"></a><span class="c1"># command plugin:</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-5"></a>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-6"></a><span class="k">class</span> <span class="nc">CommandServe</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-7"></a>    <span class="sd">"""Start test server."""</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-8"></a>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-9"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s2">"serve"</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-10"></a>    <span class="n">doc_usage</span> <span class="o">=</span> <span class="s2">"[options]"</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-11"></a>    <span class="n">doc_purpose</span> <span class="o">=</span> <span class="s2">"start the test webserver"</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-12"></a>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-13"></a>    <span class="n">cmd_options</span> <span class="o">=</span> <span class="p">(</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-14"></a>        <span class="p">{</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-15"></a>            <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'port'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-16"></a>            <span class="s1">'short'</span><span class="p">:</span> <span class="s1">'p'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-17"></a>            <span class="s1">'long'</span><span class="p">:</span> <span class="s1">'port'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-18"></a>            <span class="s1">'default'</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-19"></a>            <span class="s1">'type'</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-20"></a>            <span class="s1">'help'</span><span class="p">:</span> <span class="s1">'Port number (default: 8000)'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-21"></a>        <span class="p">},</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-22"></a>        <span class="p">{</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-23"></a>            <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'address'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-24"></a>            <span class="s1">'short'</span><span class="p">:</span> <span class="s1">'a'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-25"></a>            <span class="s1">'long'</span><span class="p">:</span> <span class="s1">'--address'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-26"></a>            <span class="s1">'type'</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-27"></a>            <span class="s1">'default'</span><span class="p">:</span> <span class="s1">'127.0.0.1'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-28"></a>            <span class="s1">'help'</span><span class="p">:</span> <span class="s1">'Address to bind (default: 127.0.0.1)'</span><span class="p">,</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-29"></a>        <span class="p">},</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-30"></a>    <span class="p">)</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-31"></a>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-32"></a>    <span class="k">def</span> <span class="nf">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-33"></a>        <span class="sd">"""Start test server."""</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-34"></a>        <span class="n">out_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">'OUTPUT_FOLDER'</span><span class="p">]</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-35"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-36"></a>            <span class="k">print</span><span class="p">(</span><span class="s2">"Error: Missing '{0}' folder?"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">out_dir</span><span class="p">))</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-37"></a>        <span class="k">else</span><span class="p">:</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-38"></a>            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-39"></a>            <span class="n">httpd</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">((</span><span class="n">options</span><span class="p">[</span><span class="s1">'address'</span><span class="p">],</span> <span class="n">options</span><span class="p">[</span><span class="s1">'port'</span><span class="p">]),</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-40"></a>                            <span class="n">OurHTTPRequestHandler</span><span class="p">)</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-41"></a>            <span class="n">sa</span> <span class="o">=</span> <span class="n">httpd</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">getsockname</span><span class="p">()</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-42"></a>            <span class="k">print</span><span class="p">(</span><span class="s2">"Serving HTTP on"</span><span class="p">,</span> <span class="n">sa</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"port"</span><span class="p">,</span> <span class="n">sa</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">"..."</span><span class="p">)</span>
<a name="rest_code_41392e3556494ff3b131a68102bfd75d-43"></a>            <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre>
<p>As men­tio­ned abo­ve, a plu­gin can have op­tions, which the user can see by doing
 <tt class="docutils literal">ni­ko­la help com­mand</tt>  and can la­ter use, for&nbsp;exam­ple:</p> 
 <pre class="code console"><a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-1"></a><span class="gp">$</span> nikola <span class="nb">help</span> serve
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-2"></a><span class="go">Purpose: start the test webserver</span>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-3"></a><span class="go">Usage:   nikola serve [options]</span>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-4"></a>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-5"></a><span class="go">Options:</span>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-6"></a><span class="go">-p ARG, --port=ARG        Port number (default: 8000)</span>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-7"></a><span class="go">-a ARG, ----address=ARG   Address to bind (default: 127.0.0.1)</span>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-8"></a>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-9"></a><span class="gp">$</span> nikola serve -p <span class="m">9000</span>
<a name="rest_code_c2ce9f85f3f64d98a98cfc2130a9741a-10"></a><span class="go">Serving HTTP on 127.0.0.1 port 9000 ...</span>
</pre>
<p>So, what can you do with com­mand­s? Well, any­thing you want, real­ly. I have im­ple­men­ted
a sort of pla­net using it. So, be crea­ti­ve, and if you do so­me­thing in­ter­es­ting,
­let me know&nbsp;;-)</p> 
 </div>
<div class="section" id="templatesystem-plugins">
<h3><a class="toc-backref" href="#id3">TemplateSystem&nbsp;Plugins</a></h3>
<p>Ni­ko­la sup­ports Ma­ko and Jin­ja2. If you pre­fer some other tem­pla­ting
­sys­tem, then you will have to write a  <tt class="docutils literal">Tem­pla­te­Sys­tem</tt>  plu­gin. He­re&#8217;s how they work.
­First, you have to create a  <tt class="docutils literal">.plu­gin</tt>  file. He­re&#8217;s the one for the Ma­ko&nbsp;plu­gin:</p> 
 <pre class="code ini"><a name="rest_code_1726d923ed62413caecce47e739f9b18-1"></a><span class="k">[Core]</span>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-2"></a><span class="na">Name</span> <span class="o">=</span> <span class="s">mako</span>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-3"></a><span class="na">Module</span> <span class="o">=</span> <span class="s">mako</span>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-4"></a>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-5"></a><span class="k">[Documentation]</span>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-6"></a><span class="na">Author</span> <span class="o">=</span> <span class="s">Roberto Alsina</span>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-7"></a><span class="na">Version</span> <span class="o">=</span> <span class="s">0.1</span>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-8"></a><span class="na">Website</span> <span class="o">=</span> <span class="s">https://getnikola.com</span>
<a name="rest_code_1726d923ed62413caecce47e739f9b18-9"></a><span class="na">Description</span> <span class="o">=</span> <span class="s">Support for Mako templates.</span>
</pre>
<div class="admonition note">
<p class="first admonition-title">Note</p> 
 <p class="last">If you want to pu­blish your plu­gin on the Plu­gin In­dex,  <a class="reference external" href="https://github.com/getnikola/plugins/blob/master/README.md">read
the docs for the In­dex</a> 
(and the .plu­gin file examples and&nbsp;ex­pla­na­tions).</p> 
 </div>
<p>You will have to re­place &#8220;ma­ko&#8221; with your tem­plate sys­tem&#8217;s na­me, and other da­ta
in the ob­vious&nbsp;ways.</p> 
 <p>The &#8220;Mo­du­le&#8221; op­tion is the name of the mo­du­le, which has to look so­me­thing like this,
a stub for a hy­po­the­ti­cal sys­tem cal­led&nbsp;&#8220;Tem­pla­ter&#8221;:</p> 
 <pre class="code python"><a name="rest_code_1d461b9c8291495ebae713201eae9563-1"></a><span class="kn">from</span> <span class="nn">nikola.plugin_categories</span> <span class="kn">import</span> <span class="n">TemplateSystem</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-2"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-3"></a><span class="c1"># You have to inherit TemplateSystem</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-4"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-5"></a><span class="k">class</span> <span class="nc">TemplaterTemplates</span><span class="p">(</span><span class="n">TemplateSystem</span><span class="p">):</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-6"></a>    <span class="sd">"""Wrapper for Templater templates."""</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-7"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-8"></a>    <span class="c1"># name has to match Name in the .plugin file</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-9"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s2">"templater"</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-10"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-11"></a>    <span class="c1"># A list of directories where the templates will be</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-12"></a>    <span class="c1"># located. Most template systems have some sort of</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-13"></a>    <span class="c1"># template loading tool that can use this.</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-14"></a>    <span class="k">def</span> <span class="nf">set_directories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">cache_folder</span><span class="p">):</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-15"></a>        <span class="sd">"""Sets the list of folders where templates are located and cache."""</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-16"></a>        <span class="k">pass</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-17"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-18"></a>    <span class="c1"># You *must* implement this, even if to return []</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-19"></a>    <span class="c1"># It should return a list of all the files that,</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-20"></a>    <span class="c1"># when changed, may affect the template's output.</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-21"></a>    <span class="c1"># usually this involves template inheritance and</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-22"></a>    <span class="c1"># inclusion.</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-23"></a>    <span class="k">def</span> <span class="nf">template_deps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template_name</span><span class="p">):</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-24"></a>        <span class="sd">"""Returns filenames which are dependencies for a template."""</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-25"></a>        <span class="k">return</span> <span class="p">[]</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-26"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-27"></a>    <span class="k">def</span> <span class="nf">render_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template_name</span><span class="p">,</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-28"></a>        <span class="sd">"""Renders template to a file using context.</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-29"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-30"></a><span class="sd">        This must save the data to output_name *and* return it</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-31"></a><span class="sd">        so that the caller may do additional processing.</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-32"></a><span class="sd">        """</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-33"></a>        <span class="k">pass</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-34"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-35"></a>    <span class="c1"># The method that does the actual rendering.</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-36"></a>    <span class="c1"># template_name is the name of the template file,</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-37"></a>    <span class="c1"># context is a dictionary containing the data the template</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-38"></a>    <span class="c1"># uses for rendering.</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-39"></a>    <span class="k">def</span> <span class="nf">render_template_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-40"></a>        <span class="sd">"""Renders template to a string using context. """</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-41"></a>        <span class="k">pass</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-42"></a>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-43"></a>    <span class="k">def</span> <span class="nf">inject_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-44"></a>        <span class="sd">"""Injects the directory with the lowest priority in the</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-45"></a><span class="sd">        template search mechanism."""</span>
<a name="rest_code_1d461b9c8291495ebae713201eae9563-46"></a>        <span class="k">pass</span>
</pre>
<p>You can see a real example in  <a class="reference external" href="https://github.com/getnikola/nikola/blob/master/nikola/plugins/template/jinja.py">the Jin­ja&nbsp;plu­gin</a></p> 
 </div>
<div class="section" id="task-plugins">
<h3><a class="toc-backref" href="#id4">Task&nbsp;Plugins</a></h3>
<p>If you want to do so­me­thing that de­pends on the da­ta in your si­te, you
­pro­ba­bly want to do a  <tt class="docutils literal">Task</tt>  plu­gin, which will make it be part of the
 <tt class="docutils literal">ni­ko­la build</tt>  com­mand. These are the cur­rent­ly avai­lable tasks, all
­pro­vi­ded by&nbsp;plu­gins:</p> 
 <div class="sidebar">
<p class="first sidebar-title">Other&nbsp;Tasks</p> 
 <p class="last">There are al­so  <tt class="docutils literal">La­te­Task</tt>  plu­gins, which are exe­cu­ted la­ter,
and  <tt class="docutils literal">Task­Mul­ti­plier</tt>  plu­gins that take a task and crea­te
­more tasks out of&nbsp;it.</p> 
 </div>
<pre class="code console"><a name="rest_code_671d04d1c81d4690afbfda5734bda440-1"></a><span class="gp">$</span> nikola list
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-2"></a><span class="go">Scanning posts....done!</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-3"></a><span class="go">build_bundles</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-4"></a><span class="go">build_less</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-5"></a><span class="go">copy_assets</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-6"></a><span class="go">copy_files</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-7"></a><span class="go">post_render</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-8"></a><span class="go">redirect</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-9"></a><span class="go">render_archive</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-10"></a><span class="go">render_galleries</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-11"></a><span class="go">render_galleries_clean</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-12"></a><span class="go">render_indexes</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-13"></a><span class="go">render_listings</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-14"></a><span class="go">render_pages</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-15"></a><span class="go">render_posts</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-16"></a><span class="go">render_rss</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-17"></a><span class="go">render_site</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-18"></a><span class="go">render_sources</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-19"></a><span class="go">render_tags</span>
<a name="rest_code_671d04d1c81d4690afbfda5734bda440-20"></a><span class="go">sitemap</span>
</pre>
<p>These have ac­cess to the  <tt class="docutils literal">site</tt>  ob­ject which contains your ti­me­line and
your&nbsp;confi­gu­ra­tion.</p> 
 <p>The cri­ti­cal bit of Task plu­gins is their  <tt class="docutils literal">gen_­tasks</tt>  me­thod, which  <tt class="docutils literal">yields</tt> 
 <a class="reference external" href="http://pydoit.org/tasks.html">doit tasks</a>.</p> 
 <p>The de­tails of how to handle de­pen­den­cies, etc., are a bit too much for this
­do­cu­ment, so I&#8217;ll just leave you with an exam­ple, the  <tt class="docutils literal">co­py_as­sets</tt>  task.
­First the  <tt class="docutils literal">task_­co­py_as­sets.­plu­gin</tt>  fi­le, which you should co­py and edit
in the lo­gi­cal&nbsp;ways:</p> 
 <pre class="code ini"><a name="rest_code_13999d4d674947f18118f45ccf13ff59-1"></a><span class="k">[Core]</span>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-2"></a><span class="na">Name</span> <span class="o">=</span> <span class="s">copy_assets</span>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-3"></a><span class="na">Module</span> <span class="o">=</span> <span class="s">task_copy_assets</span>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-4"></a>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-5"></a><span class="k">[Documentation]</span>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-6"></a><span class="na">Author</span> <span class="o">=</span> <span class="s">Roberto Alsina</span>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-7"></a><span class="na">Version</span> <span class="o">=</span> <span class="s">0.1</span>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-8"></a><span class="na">Website</span> <span class="o">=</span> <span class="s">https://getnikola.com</span>
<a name="rest_code_13999d4d674947f18118f45ccf13ff59-9"></a><span class="na">Description</span> <span class="o">=</span> <span class="s">Copy theme assets into output.</span>
</pre>
<div class="admonition note">
<p class="first admonition-title">Note</p> 
 <p class="last">If you want to pu­blish your plu­gin on the Plu­gin In­dex,  <a class="reference external" href="https://github.com/getnikola/plugins/blob/master/README.md">read
the docs for the In­dex</a> 
(and the .plu­gin file examples and&nbsp;ex­pla­na­tions).</p> 
 </div>
<p>And the  <tt class="docutils literal">task_­co­py_as­sets.­py</tt>  fi­le, in its&nbsp;en­ti­re­ty:</p> 
 <pre class="code python"><a name="rest_code_272a71e78c8e478da9ef3d96adc61973-1"></a><span class="kn">import</span> <span class="nn">os</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-2"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-3"></a><span class="kn">from</span> <span class="nn">nikola.plugin_categories</span> <span class="kn">import</span> <span class="n">Task</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-4"></a><span class="kn">from</span> <span class="nn">nikola</span> <span class="kn">import</span> <span class="n">utils</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-5"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-6"></a><span class="c1"># Have to inherit Task to be a task plugin</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-7"></a><span class="k">class</span> <span class="nc">CopyAssets</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-8"></a>    <span class="sd">"""Copy theme assets into output."""</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-9"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-10"></a>    <span class="n">name</span> <span class="o">=</span> <span class="s2">"copy_assets"</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-11"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-12"></a>    <span class="c1"># This yields the tasks</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-13"></a>    <span class="k">def</span> <span class="nf">gen_tasks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-14"></a>        <span class="sd">"""Create tasks to copy the assets of the whole theme chain.</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-15"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-16"></a><span class="sd">        If a file is present on two themes, use the version</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-17"></a><span class="sd">        from the "youngest" theme.</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-18"></a><span class="sd">        """</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-19"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-20"></a>        <span class="c1"># I put all the configurations and data the plugin uses</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-21"></a>        <span class="c1"># in a dictionary because utils.config_changed will</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-22"></a>        <span class="c1"># make it so that if these change, this task will be</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-23"></a>        <span class="c1"># marked out of date, and run again.</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-24"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-25"></a>        <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-26"></a>            <span class="s2">"themes"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">THEMES</span><span class="p">,</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-27"></a>            <span class="s2">"output_folder"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">'OUTPUT_FOLDER'</span><span class="p">],</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-28"></a>            <span class="s2">"filters"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">'FILTERS'</span><span class="p">],</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-29"></a>        <span class="p">}</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-30"></a>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-31"></a>        <span class="n">tasks</span> <span class="o">=</span> <span class="p">{}</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-32"></a>        <span class="k">for</span> <span class="n">theme_name</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">[</span><span class="s1">'themes'</span><span class="p">]:</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-33"></a>            <span class="n">src</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">get_theme_path</span><span class="p">(</span><span class="n">theme_name</span><span class="p">),</span> <span class="s1">'assets'</span><span class="p">)</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-34"></a>            <span class="n">dst</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kw</span><span class="p">[</span><span class="s1">'output_folder'</span><span class="p">],</span> <span class="s1">'assets'</span><span class="p">)</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-35"></a>            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">copy_tree</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-36"></a>                <span class="k">if</span> <span class="n">task</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-37"></a>                    <span class="k">continue</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-38"></a>                <span class="n">tasks</span><span class="p">[</span><span class="n">task</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">task</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-39"></a>                <span class="n">task</span><span class="p">[</span><span class="s1">'uptodate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'uptodate'</span><span class="p">,</span> <span class="p">[])</span> <span class="o">+</span> \
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-40"></a>                    <span class="p">[</span><span class="n">utils</span><span class="o">.</span><span class="n">config_changed</span><span class="p">(</span><span class="n">kw</span><span class="p">)]</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-41"></a>                <span class="n">task</span><span class="p">[</span><span class="s1">'basename'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-42"></a>                <span class="c1"># If your task generates files, please do this.</span>
<a name="rest_code_272a71e78c8e478da9ef3d96adc61973-43"></a>                <span class="k">yield</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_filters</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">kw</span><span class="p">[</span><span class="s1">'filters'</span><span class="p">])</span>
</pre>
</div>
<div class="section" id="pagecompiler-plugins">
<h3><a class="toc-backref" href="#id5">PageCompiler&nbsp;Plugins</a></h3>
<p>These plu­gins im­ple­ment mar­kup lan­gua­ges, they take sources for posts or pages and
­create HTML or other out­put files. A good example is  <a class="reference external" href="https://github.com/getnikola/plugins/tree/master/v7/misaka">the mi­sa­ka&nbsp;plu­gin.</a></p> 
 <p>They must&nbsp;pro­vi­de:</p> 
 <dl class="docutils">
<dt><tt class="docutils literal">compile_html</tt></dt>
<dd>Function that builds a&nbsp;file.</dd>
<dt><tt class="docutils literal">create_post</tt></dt>
<dd>Function that creates an empty file with some metadata in&nbsp;it.</dd>
</dl>
<p>If the com­pi­ler pro­duces so­me­thing other than HTML fi­les, it should al­so im­ple­ment  <tt class="docutils literal">ex­ten­sion</tt>  whi­ch
­re­turns the pre­fer­red ex­ten­sion for the out­put&nbsp;file.</p> 
 <p>These plu­gins can al­so be used to ex­tract me­ta­da­ta from a file. To do so, the
­plu­gin may im­ple­ment  <tt class="docutils literal">read_­me­ta­da­ta</tt>  that will re­turn a dict contai­ning the
­me­ta­da­ta contai­ned in the&nbsp;file.</p> 
 </div>
<div class="section" id="restextension-plugins">
<h3><a class="toc-backref" href="#id6">RestExtension&nbsp;Plugins</a></h3>
<p>Im­ple­ment di­rec­tives for re­Struc­tu­red­Text, see  <a class="reference external" href="https://github.com/getnikola/nikola/blob/master/nikola/plugins/compile/rest/media.py">me­dia.­py</a>  for a simple&nbsp;example.</p> 
 <p>If your out­put de­pends on a config va­lue, you need to make your post re­cord a
­de­pen­den­cy on a pseu­do-­pa­th, like&nbsp;this:</p> 
 <pre class="code text"><a name="rest_code_fc01ef341c8349888412d6c7a40c2c3b-1"></a>####MAGIC####CONFIG:OPTIONNAME
</pre>
<p>Then, whe­ne­ver the  <tt class="docutils literal">OP­TION­NAME</tt>  op­tion is chan­ged in conf.­py, the file will be&nbsp;re­built.</p> 
 <p>If your di­rec­tive de­pends or may de­pend on the whole ti­me­line (like the
 <tt class="docutils literal"><span class="pre">post-­­list</span></tt>  di­rec­ti­ve, where ad­ding new posts to the site could make it
s­ta­le), you should re­cord a de­pen­den­cy on the pseu­do-­pa­th
 <tt class="docutils literal"><span class="pre">####­­MA­­GIC####­­TI­­ME­­LINE</span></tt>.</p> 
 </div>
<div class="section" id="markdownextension-plugins">
<h3><a class="toc-backref" href="#id7">MarkdownExtension&nbsp;Plugins</a></h3>
<p>Im­ple­ment Mark­down ex­ten­sions, see  <a class="reference external" href="https://github.com/getnikola/nikola/blob/master/nikola/plugins/compile/markdown/mdx_nikola.py">mdx_­ni­ko­la.­py</a>  for a simple&nbsp;example.</p> 
 <p>Note that Py­thon mark­down ex­ten­sions are of­ten al­so avai­lable as se­pa­ra­te
­pa­ckages. This is on­ly meant to ship ex­ten­sions along with&nbsp;Ni­ko­la.</p> 
 </div>
<div class="section" id="signalhandler-plugins">
<h3><a class="toc-backref" href="#id8">SignalHandler&nbsp;Plugins</a></h3>
<p>These plu­gins ex­tend the  <tt class="docutils literal">Si­gnal­Hand­ler</tt>  class and connect to one or mo­re
­si­gnals via  <a class="reference external" href="http://pythonhosted.org/blinker/">blin­ker</a>.</p> 
 <p>The ea­siest way to do this is to reim­ple­ment  <tt class="docutils literal">set_­si­te()</tt>  and just connect to
w­ha­te­ver si­gnals you want&nbsp;there.</p> 
 <p>Cur­rent­ly Ni­ko­la emits the fol­lo­wing&nbsp;si­gnals:</p> 
 <dl class="docutils">
<dt><tt class="docutils literal">sighandlers_loaded</tt></dt>
<dd>Right after SignalHandler plugin&nbsp;activation.</dd>
<dt><tt class="docutils literal">initialized</tt></dt>
<dd>When all tasks are&nbsp;loaded.</dd>
<dt><tt class="docutils literal">configured</tt></dt>
<dd>When all the configuration file is processed. Note that plugins are activated before this is&nbsp;emitted.</dd>
<dt><tt class="docutils literal">scanned</tt></dt>
<dd>After posts are&nbsp;scanned.</dd>
<dt>
<tt class="docutils literal">new_post</tt> / <tt class="docutils literal">new_page</tt>
</dt>
<dd>When a new post is created, using the <tt class="docutils literal">nikola new_post</tt>/<tt class="docutils literal">nikola new_page</tt> commands.  The signal
data contains the path of the file, and the metadata file (if there is&nbsp;one).</dd>
<dt>
<tt class="docutils literal">existing_post</tt> / <tt class="docutils literal">existing_page</tt>
</dt>
<dd>When a new post fails to be created due to a title conflict. Contains the same data as <tt class="docutils literal">new_post</tt>.</dd>
<dt><tt class="docutils literal">deployed</tt></dt>
<dd>
<p class="first">When the  <tt class="docutils literal">ni­ko­la de­ploy</tt>  com­mand is run, and there is at least one new
en­try/­post since  <tt class="docutils literal">last_­de­ploy</tt>.  The si­gnal da­ta is of the&nbsp;form:</p> 
 <pre class="last literal-block">
{
 'last_deploy: # datetime object for the last deployed time,
 'new_deploy': # datetime object for the current deployed time,
 'clean': # whether there was a record of a last deployment,
 'deployed': # all files deployed after the last deploy,
 'undeployed': # all files not deployed since they are either future posts/drafts
}
</pre>
</dd>
<dt><tt class="docutils literal">compiled</tt></dt>
<dd>
<p class="first">When a post/­page is com­pi­led from its source to html, be­fore any­thing else is done with it.  The si­gnal
­da­ta is in the&nbsp;form:</p> 
 <pre class="last literal-block">
{
 'source': # the path to the source file
 'dest': # the path to the cache file for the post/page
 'post': # the Post object for the post/page
}
</pre>
</dd>
</dl>
<p>One example is the  <a class="reference external" href="https://github.com/getnikola/plugins/tree/master/v6/deploy_hooks">de­ploy_­hooks&nbsp;plu­gin.</a></p> 
 </div>
<div class="section" id="configplugin-plugins">
<h3><a class="toc-backref" href="#id9">ConfigPlugin&nbsp;Plugins</a></h3>
<p>Does no­thing spe­ci­fic, can be used to mo­di­fy the site ob­ject (and thus the&nbsp;config).</p> 
 <p>Put all the ma­gic you want in  <tt class="docutils literal">set_­si­te()</tt>, and don’t for­get to run the one
­from  <tt class="docutils literal">su­per­()</tt>. Example  plu­gin:  <a class="reference external" href="https://github.com/getnikola/plugins/tree/master/v7/navstories">navs­to­ries</a></p> 
 </div>
<div class="section" id="postscanner-plugins">
<h3><a class="toc-backref" href="#id10">PostScanner&nbsp;Plugins</a></h3>
<p>Get posts and sto­ries from &#8220;so­mew­he­re&#8221; to be ad­ded to the ti­me­line.
The on­ly cur­rent­ly exis­ting plu­gin of this kind reads them from&nbsp;disk.</p> 
 </div>
</div>
<div class="section" id="plugin-index">
<h2><a class="toc-backref" href="#id11">Plugin&nbsp;Index</a></h2>
<p>There is a  <a class="reference external" href="https://plugins.getnikola.com/">plu­gin in­dex</a>, which stores all
of the plu­gins for Ni­ko­la people wan­ted to share with the&nbsp;world.</p> 
 <p>You may want to read the  <a class="reference external" href="https://github.com/getnikola/plugins/blob/master/README.md">README for the In­dex</a>  if you want to
­pu­blish your pa­ckage&nbsp;there.</p> 
 </div>
<div class="section" id="path-link-resolution-mechanism">
<h2><a class="toc-backref" href="#id12">Path/Link Resolution&nbsp;Mechanism</a></h2>
<p>Any plu­gin can re­gis­ter a func­tion using  <tt class="docutils literal">Ni­ko­la.­re­gis­ter_­pa­th_­hand­ler</tt>  to
al­low re­so­lu­tion of paths and links. These are use­ful for tem­pla­tes, whi­ch
­can ac­cess them via  <tt class="docutils literal">_link</tt>.</p> 
 <p>For exam­ple, you can al­ways get a link to the path for the feed of the &#8220;foo&#8221; tag
­by using  <tt class="docutils literal"><span class="pre">_link('tag_rss',</span>   'foo')</tt>  or the  <tt class="docutils literal"><span class="pre">link://­­tag_rss/­­foo</span></tt>  URL.</p> 
 <p>He­re&#8217;s the re­le­vant code from the tag&nbsp;plu­gin.</p> 
 <pre class="code python"><a name="rest_code_208c8ff2fc274f72938709906dfe2878-1"></a><span class="c1"># In set_site</span>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-2"></a><span class="n">site</span><span class="o">.</span><span class="n">register_path_handler</span><span class="p">(</span><span class="s1">'tag_rss'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_rss_path</span><span class="p">)</span>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-3"></a>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-4"></a><span class="c1"># And these always take name and lang as arguments and returl a list of</span>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-5"></a><span class="c1"># path elements.</span>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-6"></a><span class="k">def</span> <span class="nf">tag_rss_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">):</span>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-7"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">_f</span> <span class="k">for</span> <span class="n">_f</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">'TRANSLATIONS'</span><span class="p">][</span><span class="n">lang</span><span class="p">],</span>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-8"></a>                          <span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">'TAG_PATH'</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">slugify_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span> <span class="o">+</span> <span class="s2">".xml"</span><span class="p">]</span> <span class="k">if</span>
<a name="rest_code_208c8ff2fc274f72938709906dfe2878-9"></a>            <span class="n">_f</span><span class="p">]</span>
</pre>
</div>
<div class="section" id="template-hooks">
<h2><a class="toc-backref" href="#id13">Template&nbsp;Hooks</a></h2>
<p>Plu­gins can use a hook sys­tem for ad­ding stuff in­to tem­plates.  In or­der to use
it, a plu­gin must re­gis­ter it­self.  The fol­lo­wing hooks cur­rent­ly&nbsp;exist:</p> 
 <ul class="simple">
<li>
<tt class="docutils literal">ex­tra­_­head</tt>  (not equal to the config&nbsp;op­tion!)</li> 
 <li>
<tt class="docutils literal">bo­dy_end</tt>  (not equal to the config&nbsp;op­tion!)</li> 
 <li><tt class="docutils literal">pa­ge_­hea­der</tt></li> 
 <li><tt class="docutils literal">me­nu</tt></li> 
 <li>
<tt class="docutils literal">me­nu_alt</tt>  (right-­side me­nu in boots­trap, af­ter  <tt class="docutils literal">me­nu</tt>  in&nbsp;ba­se)</li> 
 <li><tt class="docutils literal">pa­ge_­foo­ter</tt></li> 
 </ul>
<p>For exam­ple, in or­der to re­gis­ter a script in­to  <tt class="docutils literal">ex­tra­_­head</tt>:</p> 
 <pre class="code python"><a name="rest_code_99f4fc1cf6fd4943a61a35ab6a2a1b51-1"></a><span class="c1"># In set_site</span>
<a name="rest_code_99f4fc1cf6fd4943a61a35ab6a2a1b51-2"></a><span class="n">site</span><span class="o">.</span><span class="n">template_hooks</span><span class="p">[</span><span class="s1">'extra_head'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'&lt;script src="/assets/js/fancyplugin.js"&gt;'</span><span class="p">)</span>
</pre>
<p>There is al­so ano­ther API avai­lable.  It al­lows use of dy­na­mi­cal­ly ge­ne­ra­ted&nbsp;HTML:</p> 
 <pre class="code python"><a name="rest_code_1c1d6c3e3fe045e6b6af87a694eec4f7-1"></a><span class="c1"># In set_site</span>
<a name="rest_code_1c1d6c3e3fe045e6b6af87a694eec4f7-2"></a><span class="k">def</span> <span class="nf">generate_html_bit</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">'js'</span><span class="p">):</span>
<a name="rest_code_1c1d6c3e3fe045e6b6af87a694eec4f7-3"></a>    <span class="k">return</span> <span class="s1">'&lt;script src="/assets/{t}/{n}.{t}"&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">ftype</span><span class="p">)</span>
<a name="rest_code_1c1d6c3e3fe045e6b6af87a694eec4f7-4"></a>
<a name="rest_code_1c1d6c3e3fe045e6b6af87a694eec4f7-5"></a><span class="n">site</span><span class="o">.</span><span class="n">template_hooks</span><span class="p">[</span><span class="s1">'extra_head'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">generate_html_bit</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="s1">'fancyplugin'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">'js'</span><span class="p">)</span>
</pre>
<p>The se­cond ar­gu­ment to  <tt class="docutils literal">ap­pend()</tt>  is used to de­ter­mine whe­ther the func­tion
­needs ac­cess to the cur­rent tem­plate context and the site.  If it is set to
 <tt class="docutils literal">True</tt>, the func­tion will al­so re­ceive  <tt class="docutils literal">site</tt>  and  <tt class="docutils literal">context</tt>  key­word
ar­gu­ments.  Example&nbsp;use:</p> 
 <pre class="code python"><a name="rest_code_e036020443da4c80817376ac0f243f95-1"></a><span class="c1"># In set_site</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-2"></a><span class="k">def</span> <span class="nf">greeting</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">endswith</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-3"></a>    <span class="k">if</span> <span class="n">context</span><span class="p">[</span><span class="s1">'lang'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'en'</span><span class="p">:</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-4"></a>        <span class="n">greet</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">'Hello'</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-5"></a>    <span class="k">elif</span> <span class="n">context</span><span class="p">[</span><span class="s1">'lang'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'es'</span><span class="p">:</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-6"></a>        <span class="n">greet</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">'¡Hola'</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-7"></a>
<a name="rest_code_e036020443da4c80817376ac0f243f95-8"></a>    <span class="n">t</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">' BLOG_TITLE = {0}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">'BLOG_TITLE'</span><span class="p">](</span><span class="n">context</span><span class="p">[</span><span class="s1">'lang'</span><span class="p">]))</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-9"></a>
<a name="rest_code_e036020443da4c80817376ac0f243f95-10"></a>    <span class="k">return</span> <span class="sa">u</span><span class="s1">'&lt;h3&gt;{greet} {addr}{endswith}&lt;/h3&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">greet</span><span class="o">=</span><span class="n">greet</span><span class="p">,</span> <span class="n">addr</span><span class="o">=</span><span class="n">addr</span><span class="p">,</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-11"></a>    <span class="n">endswith</span><span class="o">=</span><span class="n">endswith</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span>
<a name="rest_code_e036020443da4c80817376ac0f243f95-12"></a>
<a name="rest_code_e036020443da4c80817376ac0f243f95-13"></a><span class="n">site</span><span class="o">.</span><span class="n">template_hooks</span><span class="p">[</span><span class="s1">'page_header'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">greeting</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'Nikola Tesla'</span><span class="p">,</span> <span class="n">endswith</span><span class="o">=</span><span class="sa">u</span><span class="s1">'!'</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="shortcodes">
<h2><a class="toc-backref" href="#id14">Shortcodes</a></h2>
<p>Some (ho­pe­ful­ly all) mar­kup com­pi­lers sup­port short­codes in these&nbsp;form­s:</p> 
 <pre class="literal-block">
{{% foo %}}  # No arguments
{{% foo bar %}}  # One argument, containing "bar"
{{% foo bar baz=bat %}}  # Two arguments, one containing "bar", one called "baz" containing "bat"

{{% foo %}}Some text{{% /foo %}}  # one argument called "data" containing "Some text"
</pre>
<p>So, if you are crea­ting a plu­gin that ge­ne­rates mar­kup, it may be a good idea
­to re­gis­ter it as a short­code in ad­di­tion of to re­struc­tu­red text di­rec­tive or
­mark­down ex­ten­sion, thus ma­king it avai­lable to all mar­kup&nbsp;for­mats.</p> 
 <p>To im­ple­ment your own short­codes from a plu­gin, you can create a plu­gin in­he­ri­ting  <tt class="docutils literal">Short­co­de­Plu­gin</tt>  and call
 <tt class="docutils literal">Ni­ko­la.­re­gis­ter_­short­co­de(­na­me, func)</tt>  with the fol­lo­wing&nbsp;ar­gu­ments:</p> 
 <dl class="docutils">
<dt>
<tt class="docutils literal">name</tt>:</dt>
<dd>Name of the shortcode (&#8220;foo&#8221; in the examples&nbsp;above)</dd>
<dt>
<tt class="docutils literal">func</tt>:</dt>
<dd>A function that will handle the&nbsp;shortcode</dd>
</dl>
<p>The short­code hand­ler  <strong>must</strong>  ac­cept the fol­lo­wing na­med ar­gu­ments (or
­va­riable key­word&nbsp;ar­gu­ments):</p> 
 <dl class="docutils">
<dt>
<tt class="docutils literal">site</tt>:</dt>
<dd>An instance of the Nikola class, to access site&nbsp;state</dd>
<dt>
<tt class="docutils literal">data</tt>:</dt>
<dd>If the shortcut is used as opening/closing tags, it will be the text
between them, otherwise <tt class="docutils literal">None</tt>.</dd>
</dl>
<p>If the short­code tag has ar­gu­ments of the form  <tt class="docutils literal">foo=­bar</tt>  they will be
­pas­sed as na­med ar­gu­ments. Eve­ry­thing else will be pas­sed as po­si­tio­nal
ar­gu­ments in the func­tion&nbsp;call.</p> 
 <p>So, for&nbsp;exam­ple:</p> 
 <pre class="literal-block">
{{% foo bar baz=bat beep %}}Some text{{% /foo %}}
</pre>
<p>As­su­ming you re­gis­te­red  <tt class="docutils literal">foo_­hand­ler</tt>  as the hand­ler func­tion for the
­short­code na­med  <tt class="docutils literal">foo</tt>, this will re­sult in the fol­lo­wing call when the abo­ve
­short­code is&nbsp;en­coun­te­red:</p> 
 <pre class="literal-block">
foo_handler("bar", "beep", baz="bat", data="Some text", site=whatever)
</pre>
<div class="section" id="template-based-shortcodes">
<h3><a class="toc-backref" href="#id15">Template-based&nbsp;Shortcodes</a></h3>
<p>Ano­ther way to de­fine a new short­code is to add a tem­plate file to the
 <tt class="docutils literal">short­codes</tt>  di­rec­to­ry of your site. The tem­plate file must have the
­short­code name as the ba­se­name and the ex­ten­sion  <tt class="docutils literal">.tm­pl</tt>. For exam­ple, if you
­want to add a new short­code na­med  <tt class="docutils literal">foo</tt>, create the tem­plate file as
 <tt class="docutils literal">short­co­des/­foo.tm­pl</tt>.</p> 
 <p>When the short­code is en­coun­te­red, the mat­ching tem­plate will be ren­de­red wi­th
its context pro­vi­ded by the ar­gu­ments gi­ven in the short­code. Key­word ar­gu­ments
are pas­sed di­rect­ly, i.e. the key be­comes the va­riable name in the tem­pla­te
­na­mes­pace with a mat­ching string va­lue. Non-­key­word ar­gu­ments are pas­sed as
s­tring va­lues in a tuple na­med  <tt class="docutils literal">_args</tt>. As for nor­mal short­codes with a
­hand­ler func­tion,  <tt class="docutils literal">site</tt>  and  <tt class="docutils literal">da­ta</tt>  will be ad­ded to the key­word&nbsp;ar­gu­ments.</p> 
 <p>Exam­ple:</p> 
 <p>The fol­lo­wing&nbsp;short­co­de:</p> 
 <pre class="literal-block">
{{% foo bar="baz" spam %}}
</pre>
<p>With a tem­plate in  <tt class="docutils literal">short­co­des/­foo.tm­pl</tt>  with this content (u­sing Jin­ja2
­syn­tax in this&nbsp;exam­ple):</p> 
 <pre class="literal-block">
&lt;div class="{{ _args[0] if _args else 'ham' }}"&gt;{{ bar }}&lt;/div&gt;
</pre>
<p>Will re­sult in this&nbsp;out­put:</p> 
 <pre class="literal-block">
&lt;div class="spam"&gt;baz&lt;/div&gt;
</pre>
</div>
</div>
<div class="section" id="state-and-cache">
<h2><a class="toc-backref" href="#id16">State and&nbsp;Cache</a></h2>
<p>So­me­times your plu­gins will need to cache things to speed up fur­ther ac­tions. Here are the conven­tions for&nbsp;that:</p> 
 <ul class="simple">
<li>If it&#8217;s a fi­le, put it so­mew­here in  <tt class="docutils literal"><span class="pre">`self.­­site.­­con­fig['CA­­CHE_­­FOL­­DER']`</span></tt>  (de­faults to  <tt class="docutils literal">`ca­che/`</tt>.</li> 
 <li>If it&#8217;s a va­lue, use  <tt class="docutils literal">`self.­site.­cache.­set(­key, va­lue)`</tt>  to set it and  <tt class="docutils literal">`self.­site.­cache.­get(­key)`</tt>  to get it.
The key should be a string, the va­lue should be json-­en­co­dable (so, be ca­re­ful with da­te­time&nbsp;ob­jects)</li> 
 </ul>
<p>The va­lues and files you store there can  <strong>and will</strong>  be de­le­ted so­me­times by the user. They should al­ways be
­things you can re­cons­truct wi­thout los­sage. They are&nbsp;thro­wa­ways.</p> 
 <p>On the other hand, so­me­times you want to save so­me­thing that is  <strong>not</strong>  a thro­wa­way. These are things that may
­change the out­put, so the user should not de­lete them. We call that  <strong>state</strong>. To save&nbsp;sta­te:</p> 
 <ul class="simple">
<li>If it&#8217;s a fi­le, put it so­mew­here in the wor­king di­rec­to­ry. Try not to do that&nbsp;please.</li> 
 <li>If it&#8217;s a va­lue, use  <tt class="docutils literal">`self.­site.state.­set(­key, va­lue)`</tt>  to set it and  <tt class="docutils literal">`self.state.­cache.­get(­key)`</tt>  to get it.
The key should be a string, the va­lue should be json-­en­co­dable (so, be ca­re­ful with da­te­time&nbsp;ob­jects)</li> 
 </ul>
<p>The  <tt class="docutils literal">`ca­che`</tt>  and  <tt class="docutils literal">`s­ta­te`</tt>  ob­jects are ra­ther sim­plis­tic, and that&#8217;s in­ten­tio­nal. They have no de­fault va­lues: if
the key is not the­re, you will get  <tt class="docutils literal">`No­ne`</tt>  and like it. They are meant to be both thread­sa­fe, but hey, who can
­gua­ran­tee that sort of&nbsp;thing?</p> 
 <p>There are no sec­tions, and no ac­cess pro­tec­tion, so let&#8217;s not use it to store pass­words and such. Use&nbsp;res­pon­si­bly.</p> 
 </div>
</div>
    </div>
    
</article>
</div>
            </div>
        </div>
        <button class="btn btn-fab btn-raised btn-material-green btn-footer" data-toggle="modal" data-target="#footer-dialog">
            <i class="mdi-communication-message"></i>
        </button>
        <div id="footer-dialog" class="modal fade" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Antipodae&nbsp;credits</h4>
 
              </div>
              <div class="modal-body">
                    Contents © 2017         <a href="mailto:mathieu@antipodae.fr">matclab</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
                    
              </div>
              <div class="modal-footer">
                <button class="btn btn-primary" data-dismiss="modal">Ok</button>
              </div>
            </div>
          </div>
        </div>
        <div class="source-button">
        </div>
        <div class="kc_fab_wrapper"></div>
</div>

            <script src="../../../assets/js/all-nocdn.js"></script><script src="../../../assets/js/colorbox-i18n/jquery.colorbox-fr.js"></script><script>
                var links = [
                        {
                            "bgcolor": "#F44336",
                            "icon": "<i class='fa fa-share-square-o'></i>",
                        },
                        {
                            "url": "https://twitter.com/",
                            "bgcolor": "#55ACEE",
                            "color": "#fffff",
                            "icon": "<i class='fa fa-twitter'></i>",
                            "target": "_blank",
                        },
                        {
                            "url": "https://github.com/",
                            "bgcolor": "#666666",
                            "color": "#fffff",
                            "icon": "<i class='fa fa-github-square'></i>",
                            "target": "_blank",
                        },
                        {
                            "url": "https://www.facebook.com",
                            "bgcolor": "#3B5998",
                            "color": "#fffff",
                            "icon": "<i class='fa fa-facebook'></i>",
                            "target": "_blank",
                        },
                ];

            $(document).ready(function() {
                // This command is used to initialize some elements and make them work properly
                $.material.init();
                    $('.kc_fab_wrapper').kc_fab(links);
            });

            $(window).on("resize", function() {
                $("html, body").height($(window).height());
                $(".main, .menu").height($(window).height() - $(".header-panel").outerHeight() - 76 ); // footer margin: $("footer.footer").outerHeight()
                $(".posts-material").height($(window).height());
            }).trigger("resize");
        </script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("fr");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>